{"version":3,"file":"draggable.esm.js","sources":["../../../node_modules/classnames/index.js","../lib/utils/helpers.ts","../lib/utils/prefix.ts","../lib/utils/dom.ts","../lib/utils/positions.ts","../lib/DragCore.tsx","../lib/hooks/useReferenceState.ts","../lib/Draggable.tsx"],"sourcesContent":["/*!\n  Copyright (c) 2018 Jed Watson.\n  Licensed under the MIT License (MIT), see\n  http://jedwatson.github.io/classnames\n*/\n/* global define */\n\n(function () {\n\t'use strict';\n\n\tvar hasOwn = {}.hasOwnProperty;\n\n\tfunction classNames() {\n\t\tvar classes = [];\n\n\t\tfor (var i = 0; i < arguments.length; i++) {\n\t\t\tvar arg = arguments[i];\n\t\t\tif (!arg) continue;\n\n\t\t\tvar argType = typeof arg;\n\n\t\t\tif (argType === 'string' || argType === 'number') {\n\t\t\t\tclasses.push(arg);\n\t\t\t} else if (Array.isArray(arg)) {\n\t\t\t\tif (arg.length) {\n\t\t\t\t\tvar inner = classNames.apply(null, arg);\n\t\t\t\t\tif (inner) {\n\t\t\t\t\t\tclasses.push(inner);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (argType === 'object') {\n\t\t\t\tif (arg.toString === Object.prototype.toString) {\n\t\t\t\t\tfor (var key in arg) {\n\t\t\t\t\t\tif (hasOwn.call(arg, key) && arg[key]) {\n\t\t\t\t\t\t\tclasses.push(key);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tclasses.push(arg.toString());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn classes.join(' ');\n\t}\n\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tclassNames.default = classNames;\n\t\tmodule.exports = classNames;\n\t} else if (typeof define === 'function' && typeof define.amd === 'object' && define.amd) {\n\t\t// register as 'classnames', consistent with npm package name\n\t\tdefine('classnames', [], function () {\n\t\t\treturn classNames;\n\t\t});\n\t} else {\n\t\twindow.classNames = classNames;\n\t}\n}());\n","import { Axis } from '../types'\n\nexport function find<T>(array: Array<T>, cb: (value: T, index: number, array: Array<T>) => any) {\n  if (!Array.isArray(array)) return undefined\n\n  for (let i = 0, { length } = array; i < length; i += 1) {\n    if (cb.apply(cb, [array[i], i, array])) return array[i]\n  }\n\n  return undefined\n}\n\nexport function isFunction(func: any) {\n  return typeof func === 'function' || Object.prototype.toString.call(func) === '[object Function]'\n}\n\nexport function isNum(number?: number) {\n  return typeof number === 'number' && !Number.isNaN(number)\n}\n\nexport function int(number: string) {\n  return parseInt(number, 10)\n}\n\nexport function snapToGrid(grid: [number, number], pendingX: number, pendingY: number) {\n  const x = Math.round(pendingX / grid[0]) * grid[0]\n  const y = Math.round(pendingY / grid[1]) * grid[1]\n\n  return [x, y]\n}\n\nexport function canDragX(axis: Axis) {\n  return axis === 'both' || axis === 'x'\n}\n\nexport function canDragY(axis: Axis) {\n  return axis === 'both' || axis === 'y'\n}\n\nexport function log(...args: any[]) {\n  // if (process.env.NODE_ENV === 'development') {\n  //   // eslint-disable-next-line\n  //   console.log(...args)\n  // }\n}\n","const prefixes = ['Moz', 'Webkit', 'O', 'ms']\n\nfunction kebabToTitleCase(str: string) {\n  let value = ''\n  let shouldCapitalize = true\n  for (let i = 0; i <= str.length; i += 1) {\n    if (shouldCapitalize) {\n      value += value[i].toUpperCase()\n      shouldCapitalize = false\n    } else if (str[i] === '-') {\n      shouldCapitalize = true\n    } else {\n      value += str[i]\n    }\n  }\n\n  return value\n}\n\nexport function browserPrefixToKey(prop: string, prefix: string) {\n  return prefix ? `${prefix}${kebabToTitleCase(prop)}` : prop\n}\n\nexport function browserPrefixToStyle(prop: string, prefix: string) {\n  return prefix ? `${prefix.toLowerCase()}-${prop}` : prop\n}\n\nexport function getPrefix(prop = 'transform') {\n  if (typeof window === 'undefined' || typeof window.document === 'undefined') return ''\n\n  const { style } = window.document.documentElement\n\n  if (prop in style) return ''\n\n  for (let i = 0; i < prefixes.length; i += 1) {\n    if (browserPrefixToKey(prop, prefixes[i]) in style) {\n      return prefixes[i]\n    }\n  }\n\n  return ''\n}\n\nexport default getPrefix()\n","import { find, isFunction, int } from './helpers'\nimport { MouseTouchEvent, ControlPosition, OffsetPositionOfControl } from '../types'\nimport browserPrefix, { browserPrefixToKey } from './prefix'\n\nexport function addClass(el: HTMLElement, classname: string) {\n  if (el.classList) {\n    el.classList.add(classname)\n  } else if (!el.className.match(new RegExp(`(?:^|\\\\s)${classname}(?!\\\\S)`))) {\n    // eslint-disable-next-line no-param-reassign\n    el.className += `${classname}`\n  }\n}\n\nexport function removeClass(el: HTMLElement, classname: string) {\n  if (el.classList) {\n    el.classList.remove(classname)\n  } else {\n    // eslint-disable-next-line no-param-reassign\n    el.className = el.className.replace(new RegExp(`(?:^|\\\\s)${classname}(?!\\\\S)`, 'g'), '')\n  }\n}\n\nexport function addEvent(\n  el: Node,\n  event: string,\n  handler: EventListenerOrEventListenerObject,\n  inputOptions?: AddEventListenerOptions\n) {\n  if (!el) return\n  const options = { capture: true, ...inputOptions }\n  if (el.addEventListener) {\n    el.addEventListener(event, handler, options)\n    // @ts-ignore\n  } else if (el.attachEvent) {\n    // @ts-ignore\n    el.attachEvent(`on${event}`, handler)\n  } else {\n    // @ts-ignore\n    // eslint-disable-next-line no-param-reassign\n    el[`on${event}`] = handler\n  }\n}\n\nexport function removeEvent(\n  el: Node,\n  event: string,\n  handler: EventListenerOrEventListenerObject,\n  inputOptions?: AddEventListenerOptions\n) {\n  if (!el) return\n  const options = { capture: true, ...inputOptions }\n  if (el.removeEventListener) {\n    el.removeEventListener(event, handler, options)\n    // @ts-ignore\n  } else if (el.detachEvent) {\n    // @ts-ignore\n    el.detachEvent(`on${event}`, handler)\n  } else {\n    // @ts-ignore\n    // eslint-disable-next-line no-param-reassign\n    el[`on${event}`] = null\n  }\n}\n\nlet matchsSelectorFunc = ''\nexport function matchSelector(el: Node, selector: string) {\n  if (!matchsSelectorFunc) {\n    matchsSelectorFunc = find(\n      [\n        'matches',\n        'webkitMatchesSelector',\n        'mozMatchesSelector',\n        'msMatchesSelector',\n        'oMatchesSelector'\n      ],\n      (method) => isFunction((el as any)[method])\n    ) as string\n  }\n\n  if (!isFunction((el as any)[matchsSelectorFunc])) return false\n  return (el as any)[matchsSelectorFunc](selector)\n}\n\nexport function matchSelectorAndParent(el: Node, selector: string, baseNode: Node) {\n  let node: (Node & ParentNode) | null | undefined = el as Node & ParentNode\n  do {\n    if (matchSelector(node, selector)) return true\n    if (node === baseNode) return false\n    node = node.parentNode\n  } while (node)\n\n  return false\n}\n\nexport function getTouch(e: MouseTouchEvent, indentifier: number) {\n  return (\n    (e.targetTouches && find<any>(e.targetTouches as any, (t) => indentifier === t.indentifier)) ||\n    (e.changedTouches && find<any>(e.changedTouches as any, (t) => indentifier === t.indentifier))\n  )\n}\n\nexport function getTouchIdentifier(e: MouseTouchEvent) {\n  if (e.targetTouches && e.targetTouches[0]) return e.targetTouches[0].identifier\n  if (e.changedTouches && e.changedTouches[0]) return e.changedTouches[0].identifier\n\n  return undefined\n}\n\nexport function offsetFromParent(\n  { clientX, clientY }: MouseTouchEvent,\n  offsetParent: Element,\n  scale: number\n) {\n  const isBody = offsetParent === offsetParent.ownerDocument.body\n  const rect = isBody ? { left: 0, top: 0 } : offsetParent.getBoundingClientRect()\n\n  const x = (clientX + offsetParent.scrollLeft - rect.left) / scale\n  const y = (clientY + offsetParent.scrollTop - rect.top) / scale\n\n  return { x, y }\n}\n\nexport function addUserSelectStyles(doc?: Document) {\n  if (!doc) return\n  let styleEl = doc.getElementById('draggable-style-el')\n  if (!styleEl) {\n    styleEl = doc.createElement('style')\n    styleEl.setAttribute('type', 'text/css')\n    styleEl.id = 'draggable-style-el'\n    styleEl.innerHTML = '.draggable-transparent-selection *::-moz-selection { all: inherit; }\\n'\n    styleEl.innerHTML = '.draggable-transparent-selection *::selection { all: inherit; }\\n'\n    doc.getElementsByTagName('head')[0].appendChild(styleEl)\n  }\n  if (doc.body) addClass(doc.body, 'draggable-transparent-selection')\n}\n\nexport function removeUserSelectStyle(doc?: Document) {\n  if (!doc) return\n  try {\n    if (doc.body) removeClass(doc.body, 'draggable-transparent-selection')\n    // @ts-ignore\n    if (doc.selection) {\n      // @ts-ignore\n      doc.getSelection.empty()\n    } else {\n      const selection = (doc.defaultView || window).getSelection()\n      if (selection && selection.type !== 'Caret') {\n        selection.removeAllRanges()\n      }\n    }\n    // eslint-disable-next-line no-empty\n  } catch (e) {}\n}\n\nexport function outerWidth(node: HTMLElement) {\n  let width = node.clientWidth\n  const computedStyle = node.ownerDocument?.defaultView?.getComputedStyle(node)\n  if (computedStyle) {\n    width += int(computedStyle.borderLeftWidth)\n    width += int(computedStyle.borderRightWidth)\n  }\n  return width\n}\n\nexport function outerHeight(node: HTMLElement) {\n  let height = node.clientHeight\n  const computedStyle = node.ownerDocument?.defaultView?.getComputedStyle(node)\n  if (computedStyle) {\n    height += int(computedStyle.borderTopWidth) + int(computedStyle.borderBottomWidth)\n    height += int(computedStyle.borderBottomWidth)\n  }\n  return height\n}\n\nexport function innerWidth(node: HTMLElement) {\n  let width = node.clientWidth\n  const computedStyle = node.ownerDocument?.defaultView?.getComputedStyle(node)\n  if (computedStyle) {\n    width -= int(computedStyle.paddingLeft)\n    width -= int(computedStyle.paddingRight)\n  }\n  return width\n}\n\nexport function innerHeight(node: HTMLElement) {\n  let height = node.clientHeight\n  const computedStyle = node.ownerDocument?.defaultView?.getComputedStyle(node)\n  if (computedStyle) {\n    height -= int(computedStyle.paddingTop)\n    height -= int(computedStyle.paddingBottom)\n  }\n  return height\n}\n\nexport function getTranslation(\n  { x, y }: ControlPosition,\n  positionOffset?: OffsetPositionOfControl,\n  unit = 'px'\n) {\n  let translation = `translate(${x}${unit}, ${y}${unit})`\n  if (positionOffset) {\n    const defaultX = `${\n      typeof positionOffset.x === 'string' ? positionOffset.x : `${positionOffset.x}${unit}`\n    }`\n    const defaultY = `${\n      typeof positionOffset.y === 'string' ? positionOffset.y : `${positionOffset.y}${unit}`\n    }`\n    translation = `translate(${defaultX}, ${defaultY})${translation}`\n  }\n\n  return translation\n}\n\nexport function createCSSTransform(\n  controlPos: ControlPosition,\n  positionOffset?: OffsetPositionOfControl\n) {\n  const translation = getTranslation(controlPos, positionOffset, 'px')\n  return { [browserPrefixToKey('transform', browserPrefix)]: translation }\n}\n\nexport function createSVGTransform(\n  controlPos: ControlPosition,\n  positionOffset?: OffsetPositionOfControl\n) {\n  const translation = getTranslation(controlPos, positionOffset, '')\n  return translation\n}\n","import { RefObject, MutableRefObject } from 'react'\n\nimport { DraggableState, MouseTouchEvent, DraggableData, BoundsShape } from '../types'\nimport { getTouch, offsetFromParent, innerWidth, outerWidth, innerHeight, outerHeight } from './dom'\nimport { isNum, int } from './helpers'\n\nfunction cloneBounds(bounds: BoundsShape): BoundsShape {\n  return {\n    left: bounds.left,\n    right: bounds.right,\n    top: bounds.top,\n    bottom: bounds.bottom\n  }\n}\n\nexport function getBoundPosition(\n  node: HTMLElement,\n  bounds: BoundsShape | string | undefined,\n  x: number,\n  y: number\n): [number, number] {\n  if (!bounds) return [x, y]\n\n  let newX = x\n  let newY = y\n  let newBounds = typeof bounds === 'string' ? {} : cloneBounds(bounds)\n\n  const { ownerDocument } = node\n  const ownerWindow = ownerDocument.defaultView\n  if (typeof bounds === 'string' && ownerWindow) {\n    let boundNode\n    if (bounds === 'parent') {\n      boundNode = node.parentNode\n    } else {\n      boundNode = ownerDocument.querySelector(bounds)\n    }\n    if (!(boundNode instanceof ownerWindow.HTMLElement)) {\n      throw new Error(`Bounds selector \"${bounds}\" not exist.`)\n    }\n    const nodeStyle = ownerWindow.getComputedStyle(node)\n    const boundNodeStyle = ownerWindow.getComputedStyle(boundNode)\n\n    newBounds = {\n      left: -node.offsetLeft + int(boundNodeStyle.paddingLeft) + int(nodeStyle.marginLeft),\n      top: -node.offsetTop + int(boundNodeStyle.paddingTop) + int(nodeStyle.marginTop),\n      right:\n        innerWidth(boundNode) -\n        outerWidth(node) -\n        node.offsetLeft +\n        int(boundNodeStyle.paddingRight) -\n        int(nodeStyle.marginRight),\n      bottom:\n        innerHeight(boundNode) -\n        outerHeight(node) -\n        node.offsetTop +\n        int(boundNodeStyle.paddingBottom) -\n        int(nodeStyle.marginBottom)\n    }\n  }\n\n  if (typeof newBounds.right === 'number' && isNum(newBounds.right))\n    newX = Math.min(newX, newBounds.right)\n  if (typeof newBounds.bottom === 'number' && isNum(newBounds.bottom))\n    newY = Math.min(newY, newBounds.bottom)\n\n  if (typeof newBounds.left === 'number' && isNum(newBounds.left))\n    newX = Math.max(newX, newBounds.left)\n  if (typeof newBounds.top === 'number' && isNum(newBounds.top))\n    newY = Math.max(newY, newBounds.top)\n\n  return [newX, newY]\n}\n\nexport function getContnrolPosition(\n  e: MouseTouchEvent,\n  draggableRef?: RefObject<HTMLElement>,\n  touchIndentifier?: number,\n  scale?: any\n) {\n  const touchObj = typeof touchIndentifier === 'number' ? getTouch(e, touchIndentifier) : null\n  if (!draggableRef?.current || (typeof touchIndentifier === 'number' && !touchObj)) return null\n\n  const node = draggableRef.current\n\n  const offsetParent =\n    draggableRef.current.offsetParent || node.offsetParent || node.ownerDocument.body\n  return offsetFromParent(touchObj || e, offsetParent, scale)\n}\n\nexport function createCoreData(\n  ref: MutableRefObject<any>,\n  state: DraggableState,\n  x: number,\n  y: number\n): DraggableData {\n  const isStart = !isNum(state.lastX)\n  const node = ref.current\n\n  if (isStart) {\n    return {\n      node,\n      deltaX: 0,\n      deltaY: 0,\n      lastX: x,\n      lastY: y,\n      x,\n      y\n    }\n  }\n  return {\n    node,\n    deltaX: x - state.lastX,\n    deltaY: y - state.lastY,\n    lastX: state.lastX,\n    lastY: state.lastY,\n    x,\n    y\n  }\n}\n\nexport function createDraggableData(state: {\n  x: number\n  y: number\n  scale: number\n  coreData: DraggableData\n}) {\n  const { coreData, x, y, scale } = state\n  return {\n    node: coreData.node,\n    x: x + coreData.deltaX / scale,\n    y: y + coreData.deltaY / scale,\n    deltaX: coreData.deltaX / scale,\n    deltaY: coreData.deltaY / scale,\n    lastX: x,\n    lastY: y\n  }\n}\n","/* eslint-disable @typescript-eslint/no-use-before-define */\nimport {\n  FC,\n  cloneElement,\n  ReactElement,\n  useRef,\n  useEffect,\n  useCallback,\n  SyntheticEvent,\n  RefObject\n} from 'react'\nimport {\n  matchSelectorAndParent,\n  getTouchIdentifier,\n  addUserSelectStyles,\n  addEvent,\n  removeUserSelectStyle,\n  removeEvent\n} from './utils/dom'\nimport { MouseTouchEvent, DraggableData } from './types'\nimport { getContnrolPosition, createCoreData } from './utils/positions'\nimport { log, snapToGrid, isFunction } from './utils/helpers'\n\nexport interface DragCoreProps {\n  /**\n   * `allowAnyClick allows dragging using any mouse btuton`\n   * Default only accept the left button\n   *\n   * Defaults to `false`\n   */\n  allowAnyClick?: boolean\n  /**\n   * If true, stop the Component from dragging.\n   */\n  disable?: boolean\n  /**\n   * Specifies a selector to be used as the drag handler.\n   */\n  handle?: string\n  cancel?: string\n  enableUserSelect?: boolean\n  scale?: number\n  grid?: [number, number]\n  domRef?: (instance: HTMLElement) => any\n  onMousedown?: (e: SyntheticEvent) => void\n  /**\n   * Emit when draggable start, if return `false`,\n   * Draggable will stop.\n   */\n  onStart?: (e: SyntheticEvent, core: DraggableData) => boolean | void\n  /**\n   * Emit when dragging, if return `false`,\n   * Draggable will stop.\n   */\n  onDrag?: (e: SyntheticEvent, core: DraggableData) => boolean | void\n  onStop?: (e: SyntheticEvent, core: DraggableData) => boolean | void\n  children: ReactElement\n}\n\nconst events = {\n  mouse: {\n    start: 'mousedown',\n    move: 'mousemove',\n    stop: 'mouseup'\n  },\n  touch: {\n    start: 'touchstart',\n    move: 'touchmove',\n    stop: 'touchend'\n  }\n}\n\nlet dragEvent = events.mouse\n\nconst DragCore: FC<DragCoreProps> = (props) => {\n  const {\n    children,\n    allowAnyClick,\n    disable,\n    handle,\n    cancel,\n    grid,\n    domRef,\n    scale = 1,\n    enableUserSelect = true,\n    onStart = () => 0,\n    onDrag = () => 0,\n    onStop = () => 0,\n    onMousedown = () => 0\n  } = props\n  const stateRef = useRef({\n    lastX: NaN,\n    lastY: NaN,\n    dragging: false,\n    touchIndentifier: undefined as number | undefined\n  })\n\n  // ref never use as function\n  // const domNode = ref as MutableRefObject<HTMLElement>\n  const domNode = useRef<HTMLElement>(null)\n\n  const handleDrag = (e: MouseTouchEvent) => {\n    const state = stateRef.current\n    const position = getContnrolPosition(e, domNode, state.touchIndentifier, scale)\n\n    if (position === null) return\n    let { x, y } = position\n    if (Array.isArray(grid)) {\n      const [deltaX, deltaY] = snapToGrid(grid, x - state.lastX, y - state.lastY)\n      if (!deltaX && !deltaY) return\n      x = state.lastX + deltaX\n      y = state.lastY + deltaY\n    }\n\n    const coreEvent = createCoreData(domNode, state, x, y)\n    log('DragCore - handleDrag: %j', coreEvent)\n\n    // Manually emit the stop event\n    const shouldUpdate = onDrag(e, coreEvent)\n    if (shouldUpdate === false) {\n      // TODO:\n      // Old browser support\n      try {\n        handleDragStop(new MouseEvent('mouseup') as MouseTouchEvent)\n      } catch (err) {\n        const event = document.createEvent('MouseEvent') as MouseTouchEvent\n        handleDragStop(event)\n      }\n      return\n    }\n\n    stateRef.current = { ...state, lastX: x, lastY: y }\n  }\n\n  const handleDragStop = (e: MouseTouchEvent) => {\n    const state = stateRef.current\n    if (!state.dragging) return\n\n    const position = getContnrolPosition(e, domNode, state.touchIndentifier, scale)\n    if (position === null) return\n    const { x, y } = position\n    const coreEvent = createCoreData(domNode, state, x, y)\n\n    const shouldContinune = onStop(e, coreEvent)\n    if (shouldContinune === false) return\n\n    if (domNode.current && enableUserSelect) {\n      removeUserSelectStyle(domNode.current.ownerDocument)\n    }\n\n    log('DragCore - handleStop: %j', coreEvent)\n\n    stateRef.current = { ...state, dragging: false, lastX: NaN, lastY: NaN }\n\n    if (domNode.current) {\n      // eslint-disable-next-line no-use-before-define\n      removeEvent(domNode.current.ownerDocument, dragEvent.move, handleDrag as EventListener)\n      removeEvent(domNode.current.ownerDocument, dragEvent.stop, handleDragStop as EventListener)\n    }\n  }\n\n  /**\n   * Handle staring\n   * @param { MouseTouchEvent } e Event\n   */\n  const handleDragStart = (e: MouseTouchEvent) => {\n    const state = stateRef.current\n    if (onMousedown) onMousedown(e)\n\n    // Only accept left click from mouse\n    if (!allowAnyClick && e.button !== 0) return\n\n    const node = domNode.current\n    const ownerDocument = node?.ownerDocument\n    if (!node || !ownerDocument || !ownerDocument.body || !ownerDocument.defaultView) {\n      throw new Error('Draggable not mounted on DragStart')\n    }\n\n    // Handle cancel \\ handle \\ disable prop.\n    if (\n      disable ||\n      !(e.target instanceof ownerDocument.defaultView.Node) ||\n      (handle && !matchSelectorAndParent(e.target, handle, node)) ||\n      (cancel && matchSelectorAndParent(e.target, cancel, node))\n    ) {\n      return\n    }\n\n    // Prevent scrolling on mobile device.\n    if (e.type === 'touchstart') e.preventDefault()\n\n    const touchIndentifier = getTouchIdentifier(e)\n    stateRef.current = { ...state, touchIndentifier }\n\n    const position = getContnrolPosition(e, domNode, touchIndentifier, scale)\n    if (position === null) return\n    const { x, y } = position\n\n    const coreEvent = createCoreData(domNode, state, x, y)\n\n    log('DragCore - handleDragStart: %j', coreEvent)\n\n    const shouldUpdate = onStart(e, coreEvent)\n    if (shouldUpdate === false) return\n\n    if (enableUserSelect) addUserSelectStyles(ownerDocument)\n\n    stateRef.current = {\n      ...state,\n      dragging: true,\n      lastX: x,\n      lastY: y\n    }\n\n    addEvent(ownerDocument, dragEvent.move, handleDrag as EventListener)\n    addEvent(ownerDocument, dragEvent.stop, handleDragStop as EventListener)\n  }\n\n  const onMouseDown = (e: MouseTouchEvent) => {\n    dragEvent = events.mouse\n    return handleDragStart(e)\n  }\n\n  const onMouseUp = (e: MouseTouchEvent) => {\n    dragEvent = events.mouse\n    return handleDragStop(e)\n  }\n\n  const onTouchStart = (e: MouseTouchEvent) => {\n    dragEvent = events.touch\n    return handleDragStart(e)\n  }\n\n  const onTouchEnd = (e: MouseTouchEvent) => {\n    dragEvent = events.touch\n    return handleDragStop(e)\n  }\n\n  useEffect(() => {\n    if (domNode.current) {\n      domRef?.(domNode.current)\n      addEvent(domNode.current, events.touch.start, onTouchStart as EventListener, {\n        passive: false\n      })\n    }\n\n    return () => {\n      if (domNode?.current) {\n        const { ownerDocument } = domNode.current\n        removeEvent(ownerDocument, events.mouse.move, handleDrag as EventListener)\n        removeEvent(ownerDocument, events.touch.move, handleDrag as EventListener)\n        removeEvent(ownerDocument, events.mouse.stop, handleDragStop as EventListener)\n        removeEvent(ownerDocument, events.touch.stop, handleDragStop as EventListener)\n        removeEvent(domNode.current, events.touch.start, onTouchStart as EventListener, {\n          passive: false\n        })\n        if (enableUserSelect) removeUserSelectStyle(ownerDocument)\n      }\n    }\n  }, [domNode])\n\n  return cloneElement(children, {\n    ref: domNode,\n    onMouseDown,\n    onMouseUp,\n    onTouchEnd\n  })\n}\n\nexport default DragCore\n","import { useState, useRef, MutableRefObject } from 'react'\n\nexport default function useReferenceState<T>(\n  initialValue: T\n): [MutableRefObject<T>, (value: T) => any, T] {\n  const [state, setState] = useState<T>(initialValue)\n  const reference = useRef<T>(state)\n\n  const setRef = (value: T) => {\n    reference.current = value\n    setState(value)\n  }\n\n  return [reference, setRef, state]\n}\n","/* eslint react/jsx-props-no-spreading: off */\nimport React, { ReactElement, FC, cloneElement, useState, useEffect, useCallback } from 'react'\nimport classNames from 'classnames'\nimport DragCore, { DragCoreProps } from './DragCore'\nimport {\n  ControlPosition,\n  DraggableEventHandler,\n  BoundsShape,\n  OffsetPositionOfControl,\n  Axis\n} from './types'\nimport { log, canDragX, canDragY } from './utils/helpers'\nimport { createDraggableData, getBoundPosition } from './utils/positions'\nimport { createSVGTransform, createCSSTransform } from './utils/dom'\nimport useReferenceState from './hooks/useReferenceState'\n\nexport interface DraggableProps extends DragCoreProps {\n  /**\n   * `axis` determines which axis the draggable can move.\n   * default 'both'\n   */\n  axis?: Axis\n\n  className?: string\n  draggingClassName?: string\n  draggedClassName?: string\n\n  /**\n   * Specifies **current** x,y position (include start) when drag end.\n   * Useful for guideline and sticked action.\n   */\n  position?: ControlPosition\n\n  /**\n   * Specifies the x,y position that the drag element should start at\n   */\n  startPosition?: ControlPosition\n  positionOffset?: OffsetPositionOfControl\n  /**\n   * Bounds is the range of movement available to the element.\n   *\n   * ⚠️ Notice that here use `offsetTop` and `offsetLeft` to calcute the bounds.\n   * If use 'parent' or specifies classname,\n   * Add `position` to the parentNode make it run perfectly.\n   */\n  bounds?: BoundsShape | string\n  children: ReactElement\n}\n\nconst Draggable: FC<DraggableProps> = (props) => {\n  const {\n    children,\n    className,\n    draggedClassName = 'dragged',\n    draggingClassName = 'dragging',\n    position,\n    bounds,\n    positionOffset,\n    scale = 1,\n    axis = 'both',\n    startPosition = { x: 0, y: 0 },\n    onStop,\n    onStart,\n    onDrag\n  } = props\n\n  // const domNode = useRef<HTMLElement>(null)\n  // const [domNode, setDomNode] = useState<HTMLElement | null>(null)\n\n  const [stateRef, setState, refState] = useReferenceState({\n    dragging: false,\n    dragged: false,\n    x: position?.x ?? startPosition.x,\n    y: position?.y ?? startPosition.y,\n    prevPropsPos: { ...position },\n    slackX: 0,\n    slackY: 0,\n    isElementSVG: false,\n    domNode: null as HTMLElement | null\n  })\n  const [childProps, setChildProps] = useState({\n    style: { ...children.props.style },\n    className: '',\n    transform: ''\n  })\n\n  // Effects\n  useEffect(() => {\n    if (\n      typeof window.SVGAElement !== 'undefined' &&\n      stateRef.current.domNode instanceof window.SVGAElement\n    ) {\n      setState({ ...stateRef.current, isElementSVG: true })\n    }\n  }, [stateRef])\n\n  useEffect(() => {\n    const state = stateRef.current\n    const controlled = Boolean(position)\n    const draggable = !controlled || state.dragging\n\n    const validatePosition = position || startPosition\n    const transformOpts = {\n      x: canDragX(axis) && draggable ? state.x : validatePosition.x,\n      y: canDragY(axis) && draggable ? state.y : validatePosition.y\n    }\n\n    let svgTransform = null\n    let cssTransform = {}\n    if (state.isElementSVG) {\n      svgTransform = createSVGTransform(transformOpts, positionOffset)\n    } else {\n      cssTransform = createCSSTransform(transformOpts, positionOffset)\n    }\n\n    const classnames = classNames(className || '', children.props.className || '', {\n      [draggedClassName]: state.dragged,\n      [draggingClassName]: state.dragging\n    })\n\n    setChildProps({\n      style: { ...childProps.style, ...cssTransform },\n      className: classnames,\n      transform: svgTransform || ''\n    })\n  }, [refState])\n\n  useEffect(() => {\n    if (position && !stateRef.current.dragging) {\n      const { x, y } = position\n      setState({ ...stateRef.current, x, y })\n    }\n  }, [position])\n\n  // Actions\n  const handleDragStart: DraggableEventHandler = (e, coreData) => {\n    const state = stateRef.current\n    log('Draggable: handleDragStart: %j', coreData)\n\n    const sholdStart =\n      onStart && onStart(e, createDraggableData({ x: state.x, y: state.y, scale, coreData }))\n    if (sholdStart === false) return false\n\n    setState({ ...state, dragging: true, dragged: true })\n    return undefined\n  }\n\n  const handleDrag: DraggableEventHandler = (e, coreData) => {\n    const state = stateRef.current\n    if (!state.dragging) return undefined\n\n    log('Draggable: handleDrag: %j', coreData)\n    const uiData = createDraggableData({ x: state.x, y: state.y, scale, coreData })\n\n    const newState = {\n      x: uiData.x,\n      y: uiData.y,\n      slackX: 0,\n      slackY: 0\n    }\n\n    // if (bounds) {\n    const { x, y } = newState\n\n    newState.x += state.slackX\n    newState.y += state.slackY\n\n    if (state.domNode) {\n      const [newStateX, newStateY] = getBoundPosition(state.domNode, bounds, newState.x, newState.y)\n      newState.x = newStateX\n      newState.y = newStateY\n\n      newState.slackX = state.slackX + (x - newState.x)\n      newState.slackY = state.slackY + (y - newState.y)\n    }\n\n    uiData.x = newState.x\n    uiData.y = newState.y\n    uiData.deltaX = newState.x - state.x\n    uiData.deltaY = newState.y - state.y\n    // }\n\n    const shouldUpdate = onDrag && onDrag(e, uiData)\n    if (shouldUpdate === false) return false\n\n    setState({ ...state, ...newState })\n    return undefined\n  }\n\n  const handleDragStop: DraggableEventHandler = (e, coreData) => {\n    const state = stateRef.current\n    if (!state.dragging) return undefined\n\n    const shouldContinune = onStop && onStop(e, coreData)\n    if (shouldContinune === false) return false\n\n    log('Draggable: onDragStop: %j', coreData)\n\n    const newState: Partial<typeof state> = {\n      dragging: false,\n      slackX: 0,\n      slackY: 0\n    }\n\n    setState({ ...state, ...newState })\n    return undefined\n  }\n\n  return (\n    <DragCore\n      {...{ ...props, onStart: handleDragStart, onDrag: handleDrag, onStop: handleDragStop }}\n      domRef={(instace) => {\n        setState({ ...stateRef.current, domNode: instace })\n      }}\n    >\n      {cloneElement(children, {\n        ...childProps\n      })}\n    </DragCore>\n  )\n}\n\nexport default Draggable\n"],"names":["hasOwn","hasOwnProperty","classNames","classes","i","arguments","length","arg","argType","push","Array","isArray","inner","apply","toString","Object","prototype","key","call","join","module","exports","default","window","find","array","cb","undefined","isFunction","func","isNum","number","Number","isNaN","int","parseInt","snapToGrid","grid","pendingX","pendingY","x","Math","round","y","canDragX","axis","canDragY","prefixes","kebabToTitleCase","str","value","shouldCapitalize","toUpperCase","browserPrefixToKey","prop","prefix","getPrefix","document","style","documentElement","addClass","el","classname","classList","add","className","match","RegExp","removeClass","remove","replace","addEvent","event","handler","inputOptions","options","capture","addEventListener","attachEvent","removeEvent","removeEventListener","detachEvent","matchsSelectorFunc","matchSelector","selector","method","matchSelectorAndParent","baseNode","node","parentNode","getTouch","e","indentifier","targetTouches","t","changedTouches","getTouchIdentifier","identifier","offsetFromParent","offsetParent","scale","clientX","clientY","isBody","ownerDocument","body","rect","left","top","getBoundingClientRect","scrollLeft","scrollTop","addUserSelectStyles","doc","styleEl","getElementById","createElement","setAttribute","id","innerHTML","getElementsByTagName","appendChild","removeUserSelectStyle","selection","getSelection","empty","defaultView","type","removeAllRanges","outerWidth","width","clientWidth","computedStyle","getComputedStyle","borderLeftWidth","borderRightWidth","outerHeight","height","clientHeight","borderTopWidth","borderBottomWidth","innerWidth","paddingLeft","paddingRight","innerHeight","paddingTop","paddingBottom","getTranslation","positionOffset","unit","translation","defaultX","defaultY","createCSSTransform","controlPos","browserPrefix","createSVGTransform","cloneBounds","bounds","right","bottom","getBoundPosition","newX","newY","newBounds","ownerWindow","boundNode","querySelector","HTMLElement","Error","nodeStyle","boundNodeStyle","offsetLeft","marginLeft","offsetTop","marginTop","marginRight","marginBottom","min","max","getContnrolPosition","draggableRef","touchIndentifier","touchObj","current","createCoreData","ref","state","isStart","lastX","deltaX","deltaY","lastY","createDraggableData","coreData","events","mouse","start","move","stop","touch","dragEvent","DragCore","props","children","allowAnyClick","disable","handle","cancel","domRef","enableUserSelect","onStart","onDrag","onStop","onMousedown","stateRef","useRef","NaN","dragging","domNode","handleDrag","position","coreEvent","shouldUpdate","handleDragStop","MouseEvent","err","createEvent","shouldContinune","handleDragStart","button","target","Node","preventDefault","onMouseDown","onMouseUp","onTouchStart","onTouchEnd","useEffect","passive","cloneElement","useReferenceState","initialValue","useState","setState","reference","setRef","Draggable","draggedClassName","draggingClassName","startPosition","dragged","prevPropsPos","slackX","slackY","isElementSVG","refState","transform","childProps","setChildProps","SVGAElement","controlled","Boolean","draggable","validatePosition","transformOpts","svgTransform","cssTransform","classnames","sholdStart","uiData","newState","newStateX","newStateY","instace"],"mappings":"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"}