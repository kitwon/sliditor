{"version":3,"file":"draggable.esm.js","sources":["../lib/utils/helpers.ts","../lib/utils/prefix.ts","../lib/utils/dom.ts","../lib/utils/positions.ts","../lib/DragCore.tsx","../lib/hooks/useReferenceState.ts","../lib/Draggable.tsx"],"sourcesContent":["export function find<T>(array: Array<T>, cb: (value: T, index: number) => void) {\n  if (!Array.isArray(array)) return undefined\n\n  for (let i = 0, { length } = array; i < length; i += 1) {\n    if (cb.apply(cb, [array[i], i, array])) return array[i]\n  }\n\n  return undefined\n}\n\nexport function isFunction(func: any) {\n  return typeof func === 'function' || Object.prototype.toString.call(func) === '[object Function]'\n}\n\nexport function isNum(number: number) {\n  return typeof number === 'number' && !Number.isNaN(number)\n}\n\nexport function int(number) {\n  return parseInt(number, 10)\n}\n\nexport function snapToGrid(grid: [number, number], pendingX: number, pendingY: number) {\n  const x = Math.round(pendingX / grid[0]) * grid[0]\n  const y = Math.round(pendingY / grid[1]) * grid[1]\n\n  return [x, y]\n}\n\nexport function canDragX(axis) {\n  return axis === 'both' || axis === 'x'\n}\n\nexport function canDragY(axis) {\n  return axis === 'both' || axis === 'y'\n}\n\nexport function log(...args) {\n  if (process.env.NODE_ENV === 'development') {\n    // eslint-disable-next-line\n    console.log(...args)\n  }\n}\n","const prefixes = ['Moz', 'Webkit', 'O', 'ms']\n\nfunction kebabToTitleCase(str: string) {\n  let value = ''\n  let shouldCapitalize = true\n  for (let i = 0; i <= str.length; i += 1) {\n    if (shouldCapitalize) {\n      value += value[i].toUpperCase()\n      shouldCapitalize = false\n    } else if (str[i] === '-') {\n      shouldCapitalize = true\n    } else {\n      value += str[i]\n    }\n  }\n\n  return value\n}\n\nexport function browserPrefixToKey(prop: string, prefix: string) {\n  return prefix ? `${prefix}${kebabToTitleCase(prop)}` : prop\n}\n\nexport function browserPrefixToStyle(prop: string, prefix: string) {\n  return prefix ? `${prefix.toLowerCase()}-${prop}` : prop\n}\n\nexport function getPrefix(prop = 'transform') {\n  if (typeof window === 'undefined' || typeof window.document === 'undefined') return ''\n\n  const { style } = window.document.documentElement\n\n  if (prop in style) return ''\n\n  for (let i = 0; i < prefixes.length; i += 1) {\n    if (browserPrefixToKey(prop, prefixes[i]) in style) {\n      return prefixes[i]\n    }\n  }\n\n  return ''\n}\n\nexport default getPrefix()\n","import { find, isFunction, int } from './helpers'\nimport { MouseTouchEvent, ControlPosition, OffsetPositionOfControl } from '../types'\nimport browserPrefix, { browserPrefixToKey } from './prefix'\n\nexport function addClass(el: HTMLElement, classname: string) {\n  if (el.classList) {\n    el.classList.add(classname)\n  } else if (!el.className.match(new RegExp(`(?:^|\\\\s)${classname}(?!\\\\S)`))) {\n    // eslint-disable-next-line no-param-reassign\n    el.className += `${classname}`\n  }\n}\n\nexport function removeClass(el: HTMLElement, classname: string) {\n  if (el.classList) {\n    el.classList.remove(classname)\n  } else {\n    // eslint-disable-next-line no-param-reassign\n    el.className = el.className.replace(new RegExp(`(?:^|\\\\s)${classname}(?!\\\\S)`, 'g'), '')\n  }\n}\n\nexport function addEvent(\n  el: Node,\n  event: string,\n  handler: EventListenerOrEventListenerObject,\n  inputOptions?: AddEventListenerOptions\n) {\n  if (!el) return\n  const options = { capture: true, ...inputOptions }\n  if (el.addEventListener) {\n    el.addEventListener(event, handler, options)\n    // @ts-ignore\n  } else if (el.attachEvent) {\n    // @ts-ignore\n    el.attachEvent(`on${event}`, handler)\n  } else {\n    // eslint-disable-next-line no-param-reassign\n    el[`on${event}`] = handler\n  }\n}\n\nexport function removeEvent(\n  el: Node,\n  event: string,\n  handler: EventListenerOrEventListenerObject,\n  inputOptions?: AddEventListenerOptions\n) {\n  if (!el) return\n  const options = { capture: true, ...inputOptions }\n  if (el.removeEventListener) {\n    el.removeEventListener(event, handler, options)\n    // @ts-ignore\n  } else if (el.detachEvent) {\n    // @ts-ignore\n    el.detachEvent(`on${event}`, handler)\n  } else {\n    // eslint-disable-next-line no-param-reassign\n    el[`on${event}`] = null\n  }\n}\n\nlet matchsSelectorFunc = ''\nexport function matchSelector(el: Node, selector: string) {\n  if (!matchsSelectorFunc) {\n    matchsSelectorFunc = find(\n      [\n        'matches',\n        'webkitMatchesSelector',\n        'mozMatchesSelector',\n        'msMatchesSelector',\n        'oMatchesSelector'\n      ],\n      (method) => isFunction(el[method])\n    )\n  }\n\n  if (!isFunction(el[matchsSelectorFunc])) return false\n  return el[matchsSelectorFunc](selector)\n}\n\nexport function matchSelectorAndParent(el: Node, selector: string, baseNode: Node) {\n  let node = el\n  do {\n    if (matchSelector(node, selector)) return true\n    if (node === baseNode) return false\n    node = node.parentNode\n  } while (node)\n\n  return false\n}\n\nexport function getTouch(e: MouseTouchEvent, indentifier: number) {\n  return (\n    (e.targetTouches && find<any>(e.targetTouches as any, (t) => indentifier === t.indentifier)) ||\n    (e.changedTouches && find<any>(e.changedTouches as any, (t) => indentifier === t.indentifier))\n  )\n}\n\nexport function getTouchIdentifier(e: MouseTouchEvent) {\n  if (e.targetTouches && e.targetTouches[0]) return e.targetTouches[0].identifier\n  if (e.changedTouches && e.changedTouches[0]) return e.changedTouches[0].identifier\n\n  return undefined\n}\n\nexport function offsetFromParent(\n  { clientX, clientY }: MouseTouchEvent,\n  offsetParent: Element,\n  scale: number\n) {\n  const isBody = offsetParent === offsetParent.ownerDocument.body\n  const rect = isBody ? { left: 0, top: 0 } : offsetParent.getBoundingClientRect()\n\n  const x = (clientX + offsetParent.scrollLeft - rect.left) / scale\n  const y = (clientY + offsetParent.scrollTop - rect.top) / scale\n\n  return { x, y }\n}\n\nexport function addUserSelectStyles(doc?: Document) {\n  if (!doc) return\n  let styleEl = doc.getElementById('draggable-style-el')\n  if (!styleEl) {\n    styleEl = doc.createElement('style')\n    styleEl.setAttribute('type', 'text/css')\n    styleEl.id = 'draggable-style-el'\n    styleEl.innerHTML = '.draggable-transparent-selection *::-moz-selection { all: inherit; }\\n'\n    styleEl.innerHTML = '.draggable-transparent-selection *::selection { all: inherit; }\\n'\n    doc.getElementsByTagName('head')[0].appendChild(styleEl)\n  }\n  if (doc.body) addClass(doc.body, 'draggable-transparent-selection')\n}\n\nexport function removeUserSelectStyle(doc?: Document) {\n  if (!doc) return\n  try {\n    if (doc.body) removeClass(doc.body, 'draggable-transparent-selection')\n    // @ts-ignore\n    if (doc.selection) {\n      // @ts-ignore\n      doc.getSelection.empty()\n    } else {\n      const selection = (doc.defaultView || window).getSelection()\n      if (selection && selection.type !== 'Caret') {\n        selection.removeAllRanges()\n      }\n    }\n    // eslint-disable-next-line no-empty\n  } catch (e) {}\n}\n\nexport function outerWidth(node: HTMLElement) {\n  let width = node.clientWidth\n  const computedStyle = node.ownerDocument.defaultView.getComputedStyle(node)\n  width += int(computedStyle.borderLeftWidth)\n  width += int(computedStyle.borderRightWidth)\n  return width\n}\n\nexport function outerHeight(node: HTMLElement) {\n  let height = node.clientHeight\n  const computedStyle = node.ownerDocument.defaultView.getComputedStyle(node)\n  height += int(computedStyle.borderTopWidth) + int(computedStyle.borderBottomWidth)\n  height += int(computedStyle.borderBottomWidth)\n  return height\n}\n\nexport function innerWidth(node: HTMLElement) {\n  let width = node.clientWidth\n  const computedStyle = node.ownerDocument.defaultView.getComputedStyle(node)\n  width -= int(computedStyle.paddingLeft)\n  width -= int(computedStyle.paddingRight)\n  return width\n}\n\nexport function innerHeight(node: HTMLElement) {\n  let height = node.clientHeight\n  const computedStyle = node.ownerDocument.defaultView.getComputedStyle(node)\n  height -= int(computedStyle.paddingTop)\n  height -= int(computedStyle.paddingBottom)\n  return height\n}\n\nexport function getTranslation(\n  { x, y }: ControlPosition,\n  positionOffset: OffsetPositionOfControl,\n  unit: string\n) {\n  let translation = `translate(${x}${unit}, ${y}${unit})`\n  if (positionOffset) {\n    const defaultX = `${\n      typeof positionOffset.x === 'string' ? positionOffset.x : `${positionOffset.x}${unit}`\n    }`\n    const defaultY = `${\n      typeof positionOffset.y === 'string' ? positionOffset.y : `${positionOffset.y}${unit}`\n    }`\n    translation = `translate(${defaultX}, ${defaultY})${translation}`\n  }\n\n  return translation\n}\n\nexport function createCSSTransform(\n  controlPos: ControlPosition,\n  positionOffset: OffsetPositionOfControl\n) {\n  const translation = getTranslation(controlPos, positionOffset, 'px')\n  return { [browserPrefixToKey('transform', browserPrefix)]: translation }\n}\n\nexport function createSVGTransform(\n  controlPos: ControlPosition,\n  positionOffset: OffsetPositionOfControl\n) {\n  const translation = getTranslation(controlPos, positionOffset, '')\n  return translation\n}\n","import { MutableRefObject } from 'react'\nimport { DraggableState, MouseTouchEvent, DraggableData, BoundsShape } from '../types'\nimport { getTouch, offsetFromParent, innerWidth, outerWidth, innerHeight, outerHeight } from './dom'\nimport { isNum, int } from './helpers'\n\nfunction cloneBounds(bounds: BoundsShape): BoundsShape {\n  return {\n    left: bounds.left,\n    right: bounds.right,\n    top: bounds.top,\n    bottom: bounds.bottom\n  }\n}\n\nexport function getBoundPosition(\n  node: HTMLElement,\n  bounds: BoundsShape | string | undefined,\n  x: number,\n  y: number\n): [number, number] {\n  if (!bounds) return [x, y]\n\n  let newX = x\n  let newY = y\n  let newBounds = typeof bounds === 'string' ? {} : cloneBounds(bounds)\n\n  if (typeof bounds === 'string') {\n    const { ownerDocument } = node\n    const ownerWindow = ownerDocument.defaultView\n    let boundNode\n    if (bounds === 'parent') {\n      boundNode = node.parentNode\n    } else {\n      boundNode = ownerDocument.querySelector(bounds)\n    }\n    if (!(boundNode instanceof ownerWindow.HTMLElement)) {\n      throw new Error(`Bounds selector \"${bounds}\" not exist.`)\n    }\n    const nodeStyle = ownerWindow.getComputedStyle(node)\n    const boundNodeStyle = ownerWindow.getComputedStyle(boundNode)\n\n    newBounds = {\n      left: -node.offsetLeft + int(boundNodeStyle.paddingLeft) + int(nodeStyle.marginLeft),\n      top: -node.offsetTop + int(boundNodeStyle.paddingTop) + int(nodeStyle.marginTop),\n      right:\n        innerWidth(boundNode) -\n        outerWidth(node) -\n        node.offsetLeft +\n        int(boundNodeStyle.paddingRight) -\n        int(nodeStyle.marginRight),\n      bottom:\n        innerHeight(boundNode) -\n        outerHeight(node) -\n        node.offsetTop +\n        int(boundNodeStyle.paddingBottom) -\n        int(nodeStyle.marginBottom)\n    }\n  }\n\n  if (isNum(newBounds.right)) newX = Math.min(newX, newBounds.right)\n  if (isNum(newBounds.bottom)) newY = Math.min(newY, newBounds.bottom)\n\n  if (isNum(newBounds.left)) newX = Math.max(newX, newBounds.left)\n  if (isNum(newBounds.top)) newY = Math.max(newY, newBounds.top)\n\n  return [newX, newY]\n}\n\nexport function getContnrolPosition(\n  e: MouseTouchEvent,\n  draggableRef: MutableRefObject<HTMLElement>,\n  touchIndentifier: number,\n  scale: any\n) {\n  const touchObj = typeof touchIndentifier === 'number' ? getTouch(e, touchIndentifier) : null\n  if (typeof touchIndentifier === 'number' && !touchObj) return null\n\n  const node = draggableRef.current\n\n  const offsetParent =\n    draggableRef.current.offsetParent || node.offsetParent || node.ownerDocument.body\n  return offsetFromParent(touchObj || e, offsetParent, scale)\n}\n\nexport function createCoreData(\n  ref: MutableRefObject<any>,\n  state: DraggableState,\n  x: number,\n  y: number\n): DraggableData {\n  const isStart = !isNum(state.lastX)\n  const node = ref.current\n\n  if (isStart) {\n    return {\n      node,\n      deltaX: 0,\n      deltaY: 0,\n      lastX: x,\n      lastY: y,\n      x,\n      y\n    }\n  }\n  return {\n    node,\n    deltaX: x - state.lastX,\n    deltaY: y - state.lastY,\n    lastX: state.lastX,\n    lastY: state.lastY,\n    x,\n    y\n  }\n}\n\nexport function createDraggableData(state: {\n  x: number\n  y: number\n  scale: number\n  coreData: DraggableData\n}) {\n  const { coreData, x, y, scale } = state\n  return {\n    node: coreData.node,\n    x: x + coreData.deltaX / scale,\n    y: y + coreData.deltaY / scale,\n    deltaX: coreData.deltaX / scale,\n    deltaY: coreData.deltaY / scale,\n    lastX: x,\n    lastY: y\n  }\n}\n","import { FC, cloneElement, ReactElement, useRef, useEffect, MutableRefObject } from 'react'\nimport {\n  matchSelectorAndParent,\n  getTouchIdentifier,\n  addUserSelectStyles,\n  addEvent,\n  removeUserSelectStyle,\n  removeEvent\n} from './utils/dom'\nimport { MouseTouchEvent, DraggableData } from './types'\nimport { getContnrolPosition, createCoreData } from './utils/positions'\nimport { log, snapToGrid, isFunction } from './utils/helpers'\n\nexport interface DragCoreProps {\n  /**\n   * `allowAnyClick allows dragging using any mouse btuton`\n   * Default only accept the left button\n   *\n   * Defaults to `false`\n   */\n  allowAnyClick?: boolean\n  /**\n   * If true, stop the Component from dragging.\n   */\n  disable?: boolean\n  /**\n   * Specifies a selector to be used as the drag handler.\n   */\n  handle?: string\n  cancel?: string\n  enableUserSelect?: boolean\n  scale?: number\n  grid?: [number, number]\n  domRef?: (instance: MutableRefObject<HTMLElement>) => any\n  onMousedown?: (e: MouseEvent) => void\n  /**\n   * Emit when draggable start, if return `false`,\n   * Draggable will stop.\n   */\n  onStart?: (e: MouseEvent, core: DraggableData) => boolean | void\n  /**\n   * Emit when dragging, if return `false`,\n   * Draggable will stop.\n   */\n  onDrag?: (e: MouseEvent, core: DraggableData) => boolean | void\n  onStop?: (e: MouseEvent, core: DraggableData) => boolean | void\n  children: ReactElement\n}\n\nconst events = {\n  mouse: {\n    start: 'mousedown',\n    move: 'mousemove',\n    stop: 'mouseup'\n  },\n  touch: {\n    start: 'touchstart',\n    move: 'touchmove',\n    stop: 'touchend'\n  }\n}\n\nlet dragEvent = events.mouse\n\nconst DragCore: FC<DragCoreProps> = (props) => {\n  const {\n    children,\n    allowAnyClick,\n    disable,\n    handle,\n    cancel,\n    grid,\n    domRef,\n    scale = 1,\n    enableUserSelect = true,\n    onStart = () => 0,\n    onDrag = () => 0,\n    onStop = () => 0,\n    onMousedown = () => 0\n  } = props\n  const stateRef = useRef({\n    lastX: NaN,\n    lastY: NaN,\n    dragging: false,\n    touchIndentifier: null\n  })\n\n  // ref never use as function\n  // const domNode = ref as MutableRefObject<HTMLElement>\n  const domNode = useRef<HTMLElement>(null)\n\n  const handleDragStop = (e: MouseTouchEvent) => {\n    const state = stateRef.current\n    if (!state.dragging) return\n\n    const position = getContnrolPosition(e, domNode, state.touchIndentifier, scale)\n    if (position === null) return\n    const { x, y } = position\n    const coreEvent = createCoreData(domNode, state, x, y)\n\n    const shouldContinune = onStop(e, coreEvent)\n    if (shouldContinune === false) return\n\n    if (domNode.current && enableUserSelect) {\n      removeUserSelectStyle(domNode.current.ownerDocument)\n    }\n\n    log('DragCore - handleStop: %j', coreEvent)\n\n    stateRef.current = { ...state, dragging: false, lastX: NaN, lastY: NaN }\n\n    if (domNode) {\n      // eslint-disable-next-line no-use-before-define\n      removeEvent(domNode.current.ownerDocument, dragEvent.move, handleDrag)\n      removeEvent(domNode.current.ownerDocument, dragEvent.stop, handleDragStop)\n    }\n  }\n\n  const handleDrag = (e: MouseTouchEvent) => {\n    const state = stateRef.current\n    const position = getContnrolPosition(e, domNode, state.touchIndentifier, scale)\n\n    if (position === null) return\n    let { x, y } = position\n    if (Array.isArray(grid)) {\n      const [deltaX, deltaY] = snapToGrid(grid, x - state.lastX, y - state.lastY)\n      if (!deltaX && !deltaY) return\n      x = state.lastX + deltaX\n      y = state.lastY + deltaY\n    }\n\n    const coreEvent = createCoreData(domNode, state, x, y)\n    log('DragCore - handleDrag: %j', coreEvent)\n\n    // Manually emit the stop event\n    const shouldUpdate = onDrag(e, coreEvent)\n    if (shouldUpdate === false) {\n      // TODO:\n      // Old browser support\n      // @ts-ignore\n      handleDragStop(new MouseEvent('mouseup'))\n      return\n    }\n\n    stateRef.current = { ...state, dragging: true, lastX: x, lastY: y }\n  }\n\n  /**\n   * Handle staring\n   * @param { MouseTouchEvent } e Event\n   */\n  const handleDragStart = (e: MouseTouchEvent) => {\n    const state = stateRef.current\n    if (onMousedown) onMousedown(e)\n\n    // Only accept left click from mouse\n    if (!allowAnyClick && e.button !== 0) return\n\n    const node = domNode.current\n    if (!node || !node.ownerDocument || !node.ownerDocument.body) {\n      throw new Error('Draggable not mounted on DragStart')\n    }\n    const { ownerDocument } = node\n\n    // Handle cancel \\ handle \\ disable prop.\n    if (\n      disable ||\n      !(e.target instanceof ownerDocument.defaultView.Node) ||\n      (handle && !matchSelectorAndParent(e.target, handle, node)) ||\n      (cancel && matchSelectorAndParent(e.target, cancel, node))\n    ) {\n      return\n    }\n\n    // Prevent scrolling on mobile device.\n    if (e.type === 'touchstart') e.preventDefault()\n\n    const touchIndentifier = getTouchIdentifier(e)\n    stateRef.current = { ...state, touchIndentifier }\n\n    const position = getContnrolPosition(e, domNode, touchIndentifier, scale)\n    if (position === null) return\n    const { x, y } = position\n\n    const coreEvent = createCoreData(domNode, state, x, y)\n\n    log('DragCore - handleDragStart: %j', coreEvent)\n\n    const shouldUpdate = onStart(e, coreEvent)\n    if (shouldUpdate === false) return\n\n    if (enableUserSelect) addUserSelectStyles(ownerDocument)\n\n    stateRef.current = {\n      ...state,\n      dragging: true,\n      lastX: x,\n      lastY: y\n    }\n\n    addEvent(ownerDocument, dragEvent.move, handleDrag)\n    addEvent(ownerDocument, dragEvent.stop, handleDragStop)\n  }\n\n  const onMouseDown = (e: MouseTouchEvent) => {\n    dragEvent = events.mouse\n    return handleDragStart(e)\n  }\n\n  const onMouseUp = (e: MouseTouchEvent) => {\n    dragEvent = events.mouse\n    return handleDragStop(e)\n  }\n\n  const onTouchStart = (e: MouseTouchEvent) => {\n    dragEvent = events.touch\n    return handleDragStart(e)\n  }\n\n  const onTouchEnd = (e: MouseTouchEvent) => {\n    dragEvent = events.touch\n    return handleDragStop(e)\n  }\n\n  useEffect(() => {\n    if (domNode) {\n      if (isFunction(domRef)) domRef(domNode)\n      addEvent(domNode.current, events.touch.start, onTouchStart, { passive: false })\n    }\n\n    return () => {\n      if (domNode?.current) {\n        const { ownerDocument } = domNode.current\n        removeEvent(ownerDocument, events.mouse.move, handleDrag)\n        removeEvent(ownerDocument, events.touch.move, handleDrag)\n        removeEvent(ownerDocument, events.mouse.stop, handleDragStop)\n        removeEvent(ownerDocument, events.touch.stop, handleDragStop)\n        removeEvent(domNode.current, events.touch.start, onTouchStart, { passive: false })\n        if (enableUserSelect) removeUserSelectStyle(ownerDocument)\n      }\n    }\n  }, [domNode])\n\n  return cloneElement(children, {\n    ref: domNode,\n    onMouseDown,\n    onMouseUp,\n    onTouchEnd\n  })\n}\n\nexport default DragCore\n","import { useState, useRef, MutableRefObject } from 'react'\n\nexport default function useReferenceState<T>(\n  initialValue: T\n): [MutableRefObject<T>, (value: T) => any, T] {\n  const [state, setState] = useState<T>(initialValue)\n  const reference = useRef<T>(state)\n\n  const setRef = (value: T) => {\n    reference.current = value\n    setState(value)\n  }\n\n  return [reference, setRef, state]\n}\n","/* eslint react/jsx-props-no-spreading: off */\nimport React, {\n  ReactElement,\n  FC,\n  cloneElement,\n  useState,\n  useEffect,\n  useRef,\n  MutableRefObject,\n  CSSProperties\n} from 'react'\nimport classNames from 'classnames'\nimport DragCore, { DragCoreProps } from './DragCore'\nimport {\n  ControlPosition,\n  DraggableEventHandler,\n  BoundsShape,\n  OffsetPositionOfControl\n} from './types'\nimport { log, canDragX, canDragY } from './utils/helpers'\nimport { createDraggableData, getBoundPosition } from './utils/positions'\nimport { createSVGTransform, createCSSTransform } from './utils/dom'\nimport useReferenceState from './hooks/useReferenceState'\n\nexport interface DraggableProps extends DragCoreProps {\n  /**\n   * `axis` determines which axis the draggable can move.\n   * default 'both'\n   */\n  axis?: 'both' | 'x' | 'y'\n\n  style?: CSSProperties\n  className?: string\n  draggingClassName?: string\n  draggedClassName?: string\n\n  /**\n   * Specifies **current** x,y position (include start) when drag end.\n   * Useful for guideline and sticked action.\n   */\n  position?: ControlPosition\n\n  /**\n   * Specifies the x,y position that the drag element should start at\n   */\n  startPosition?: ControlPosition\n  positionOffset?: OffsetPositionOfControl\n  /**\n   * Bounds is the range of movement available to the element.\n   *\n   * ⚠️ Notice that here use `offsetTop` and `offsetLeft` to calcute the bounds.\n   * If use 'parent' or specifies classname,\n   * Add `position` to the parentNode make it run perfectly.\n   */\n  bounds?: BoundsShape | string\n  children: ReactElement\n}\n\nconst Draggable: FC<DraggableProps> = (props) => {\n  const {\n    children,\n    style,\n    className,\n    draggedClassName,\n    draggingClassName,\n    position,\n    bounds,\n    positionOffset,\n    scale = 1,\n    axis = 'both',\n    startPosition = { x: 0, y: 0 },\n    onStop,\n    onStart,\n    onDrag\n  } = props\n\n  const domNode = useRef<HTMLElement>(null)\n\n  const [stateRef, setState, refState] = useReferenceState({\n    dragging: false,\n    dragged: false,\n    x: position?.x ?? startPosition.x,\n    y: position?.y ?? startPosition.y,\n    prevPropsPos: { ...position },\n    slackX: 0,\n    slackY: 0,\n    isElementSVG: false\n  })\n  const [childProps, setChildProps] = useState({\n    style: {},\n    className: '',\n    transform: ''\n  })\n\n  // Effects\n  useEffect(() => {\n    if (\n      typeof window.SVGAElement !== 'undefined' &&\n      domNode.current instanceof window.SVGAElement\n    ) {\n      setState({ ...stateRef.current, isElementSVG: true })\n    }\n  }, [domNode])\n\n  useEffect(() => {\n    const state = stateRef.current\n    const controlled = Boolean(position)\n    const draggable = !controlled || state.dragging\n\n    const validatePosition = position || startPosition\n    const transformOpts = {\n      x: canDragX(axis) && draggable ? state.x : validatePosition.x,\n      y: canDragY(axis) && draggable ? state.y : validatePosition.y\n    }\n\n    let svgTransform = null\n    let cssTransform = {}\n    if (state.isElementSVG) {\n      svgTransform = createSVGTransform(transformOpts, positionOffset)\n    } else {\n      cssTransform = createCSSTransform(transformOpts, positionOffset)\n    }\n\n    const classnames = classNames(className || '', children.props.className || '', {\n      [draggedClassName]: state.dragged,\n      [draggingClassName]: state.dragging\n    })\n\n    setChildProps({\n      style: { ...style, ...cssTransform },\n      className: classnames,\n      transform: svgTransform\n    })\n  }, [refState])\n\n  useEffect(() => {\n    if (position && !stateRef.current.dragging) {\n      const { x, y } = position\n      setState({ ...stateRef.current, x, y })\n    }\n  }, [position])\n\n  // Actions\n  const handleDragStart: DraggableEventHandler = (e, coreData) => {\n    const state = stateRef.current\n    log('Draggable: handleDragStart: %j', coreData)\n\n    const sholdStart =\n      onStart && onStart(e, createDraggableData({ x: state.x, y: state.y, scale, coreData }))\n    if (sholdStart === false) return false\n\n    setState({ ...state, dragging: true, dragged: true })\n    return undefined\n  }\n\n  const handleDrag: DraggableEventHandler = (e, coreData) => {\n    const state = stateRef.current\n    if (!state.dragging) return undefined\n\n    log('Draggable: handleDrag: %j', coreData)\n    const uiData = createDraggableData({ x: state.x, y: state.y, scale, coreData })\n\n    const newState: Partial<typeof state> = {\n      x: uiData.x,\n      y: uiData.y\n    }\n\n    if (bounds) {\n      const { x, y } = newState\n\n      newState.x += state.slackX\n      newState.y += state.slackY\n\n      const [newStateX, newStateY] = getBoundPosition(\n        domNode.current,\n        bounds,\n        newState.x,\n        newState.y\n      )\n      newState.x = newStateX\n      newState.y = newStateY\n\n      newState.slackX = state.slackX + (x - newState.x)\n      newState.slackY = state.slackY + (y - newState.y)\n\n      uiData.x = newState.x\n      uiData.y = newState.y\n      uiData.deltaX = newState.x - state.x\n      uiData.deltaY = newState.y - state.y\n    }\n\n    const shouldUpdate = onDrag && onDrag(e, uiData)\n    if (shouldUpdate === false) return false\n\n    setState({ ...state, ...newState })\n    return undefined\n  }\n\n  const handleDragStop: DraggableEventHandler = (e, coreData) => {\n    const state = stateRef.current\n    if (!state.dragging) return undefined\n\n    const shouldContinune = onStop && onStop(e, coreData)\n    if (shouldContinune === false) return false\n\n    log('Draggable: onDragStop: %j', coreData)\n\n    const newState: Partial<typeof state> = {\n      dragging: false,\n      slackX: 0,\n      slackY: 0\n    }\n\n    setState({ ...state, ...newState })\n    return undefined\n  }\n\n  return (\n    <DragCore\n      {...{ ...props, onStart: handleDragStart, onDrag: handleDrag, onStop: handleDragStop }}\n      domRef={(instace) => {\n        domNode.current = instace.current\n      }}\n    >\n      {cloneElement(children, {\n        ...childProps\n      })}\n    </DragCore>\n  )\n}\n\nexport default Draggable\n"],"names":["find","array","cb","Array","isArray","undefined","i","length","apply","isFunction","func","Object","prototype","toString","call","isNum","number","Number","isNaN","int","parseInt","snapToGrid","grid","pendingX","pendingY","x","Math","round","y","canDragX","axis","canDragY","log","process","env","NODE_ENV","console","prefixes","kebabToTitleCase","str","value","shouldCapitalize","toUpperCase","browserPrefixToKey","prop","prefix","getPrefix","window","document","style","documentElement","addClass","el","classname","classList","add","className","match","RegExp","removeClass","remove","replace","addEvent","event","handler","inputOptions","options","capture","addEventListener","attachEvent","removeEvent","removeEventListener","detachEvent","matchsSelectorFunc","matchSelector","selector","method","matchSelectorAndParent","baseNode","node","parentNode","getTouch","e","indentifier","targetTouches","t","changedTouches","getTouchIdentifier","identifier","offsetFromParent","offsetParent","scale","clientX","clientY","isBody","ownerDocument","body","rect","left","top","getBoundingClientRect","scrollLeft","scrollTop","addUserSelectStyles","doc","styleEl","getElementById","createElement","setAttribute","id","innerHTML","getElementsByTagName","appendChild","removeUserSelectStyle","selection","getSelection","empty","defaultView","type","removeAllRanges","outerWidth","width","clientWidth","computedStyle","getComputedStyle","borderLeftWidth","borderRightWidth","outerHeight","height","clientHeight","borderTopWidth","borderBottomWidth","innerWidth","paddingLeft","paddingRight","innerHeight","paddingTop","paddingBottom","getTranslation","positionOffset","unit","translation","defaultX","defaultY","createCSSTransform","controlPos","browserPrefix","createSVGTransform","cloneBounds","bounds","right","bottom","getBoundPosition","newX","newY","newBounds","ownerWindow","boundNode","querySelector","HTMLElement","Error","nodeStyle","boundNodeStyle","offsetLeft","marginLeft","offsetTop","marginTop","marginRight","marginBottom","min","max","getContnrolPosition","draggableRef","touchIndentifier","touchObj","current","createCoreData","ref","state","isStart","lastX","deltaX","deltaY","lastY","createDraggableData","coreData","events","mouse","start","move","stop","touch","dragEvent","DragCore","props","children","allowAnyClick","disable","handle","cancel","domRef","enableUserSelect","onStart","onDrag","onStop","onMousedown","stateRef","useRef","NaN","dragging","domNode","handleDragStop","position","coreEvent","shouldContinune","handleDrag","shouldUpdate","MouseEvent","handleDragStart","button","target","Node","preventDefault","onMouseDown","onMouseUp","onTouchStart","onTouchEnd","useEffect","passive","cloneElement","useReferenceState","initialValue","useState","setState","reference","setRef","Draggable","draggedClassName","draggingClassName","startPosition","dragged","prevPropsPos","slackX","slackY","isElementSVG","refState","transform","childProps","setChildProps","SVGAElement","controlled","Boolean","draggable","validatePosition","transformOpts","svgTransform","cssTransform","classnames","classNames","sholdStart","uiData","newState","newStateX","newStateY","instace"],"mappings":"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"}