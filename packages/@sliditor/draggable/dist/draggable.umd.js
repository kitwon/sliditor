!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("react"),require("classnames")):"function"==typeof define&&define.amd?define(["exports","react","classnames"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).draggable={},t.React,t.classNames)}(this,(function(t,e,n){"use strict";var r="default"in e?e.default:e;function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(){return(a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,a=void 0;try{for(var c,i=t[Symbol.iterator]();!(r=(c=i.next()).done)&&(n.push(c.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{r||null==i.return||i.return()}finally{if(o)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return l(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s(t,e){if(Array.isArray(t))for(var n=0,r=t.length;n<r;n+=1)if(e.apply(e,[t[n],n,t]))return t[n]}function f(t){return"function"==typeof t||"[object Function]"===Object.prototype.toString.call(t)}function d(t){return"number"==typeof t&&!Number.isNaN(t)}function g(t){return parseInt(t,10)}function p(t){return"both"===t||"x"===t}function y(t){return"both"===t||"y"===t}function m(){var t;"development"===process.env.NODE_ENV&&(t=console).log.apply(t,arguments)}n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n;var v=["Moz","Webkit","O","ms"];function h(t,e){return e?"".concat(e).concat(function(t){for(var e="",n=!0,r=0;r<=t.length;r+=1)n?(e+=e[r].toUpperCase(),n=!1):"-"===t[r]?n=!0:e+=t[r];return e}(t)):t}var b=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"transform";if("undefined"==typeof window||void 0===window.document)return"";var e=window.document.documentElement.style;if(t in e)return"";for(var n=0;n<v.length;n+=1)if(h(t,v[n])in e)return v[n];return""}();function w(t,e,n,r){if(t){var o=i({capture:!0},r);t.addEventListener?t.addEventListener(e,n,o):t.attachEvent?t.attachEvent("on".concat(e),n):t["on".concat(e)]=n}}function x(t,e,n,r){if(t){var o=i({capture:!0},r);t.removeEventListener?t.removeEventListener(e,n,o):t.detachEvent?t.detachEvent("on".concat(e),n):t["on".concat(e)]=null}}var S="";function D(t,e){return S||(S=s(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],(function(e){return f(t[e])}))),!!f(t[S])&&t[S](e)}function E(t,e,n){var r=t;do{if(D(r,e))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1}function O(t){if(t){var e,n,r=t.getElementById("draggable-style-el");r||((r=t.createElement("style")).setAttribute("type","text/css"),r.id="draggable-style-el",r.innerHTML=".draggable-transparent-selection *::-moz-selection { all: inherit; }\n",r.innerHTML=".draggable-transparent-selection *::selection { all: inherit; }\n",t.getElementsByTagName("head")[0].appendChild(r)),t.body&&(e=t.body,n="draggable-transparent-selection",e.classList?e.classList.add(n):e.className.match(new RegExp("(?:^|\\s)".concat(n,"(?!\\S)")))||(e.className+="".concat(n)))}}function j(t){var e,n;if(t)try{if(t.body&&(e=t.body,n="draggable-transparent-selection",e.classList?e.classList.remove(n):e.className=e.className.replace(new RegExp("(?:^|\\s)".concat(n,"(?!\\S)"),"g"),"")),t.selection)t.getSelection.empty();else{var r=(t.defaultView||window).getSelection();r&&"Caret"!==r.type&&r.removeAllRanges()}}catch(t){}}function N(t){var e=t.clientWidth,n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=g(n.borderLeftWidth),e+=g(n.borderRightWidth)}function T(t){var e=t.clientHeight,n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=g(n.borderTopWidth)+g(n.borderBottomWidth),e+=g(n.borderBottomWidth)}function X(t){var e=t.clientWidth,n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=g(n.paddingLeft),e-=g(n.paddingRight)}function Y(t){var e=t.clientHeight,n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=g(n.paddingTop),e-=g(n.paddingBottom)}function M(t,e,n){var r=t.x,o=t.y,a="translate(".concat(r).concat(n,", ").concat(o).concat(n,")");if(e){var c="".concat("string"==typeof e.x?e.x:"".concat(e.x).concat(n)),i="".concat("string"==typeof e.y?e.y:"".concat(e.y).concat(n));a="translate(".concat(c,", ").concat(i,")").concat(a)}return a}function C(t,e,n,r){var o="number"==typeof n?function(t,e){return t.targetTouches&&s(t.targetTouches,(function(t){return e===t.indentifier}))||t.changedTouches&&s(t.changedTouches,(function(t){return e===t.indentifier}))}(t,n):null;if("number"==typeof n&&!o)return null;var a=e.current;return function(t,e,n){var r=t.clientX,o=t.clientY,a=e===e.ownerDocument.body?{left:0,top:0}:e.getBoundingClientRect();return{x:(r+e.scrollLeft-a.left)/n,y:(o+e.scrollTop-a.top)/n}}(o||t,e.current.offsetParent||a.offsetParent||a.ownerDocument.body,r)}function L(t,e,n,r){var o=!d(e.lastX),a=t.current;return o?{node:a,deltaX:0,deltaY:0,lastX:n,lastY:r,x:n,y:r}:{node:a,deltaX:n-e.lastX,deltaY:r-e.lastY,lastX:e.lastX,lastY:e.lastY,x:n,y:r}}function P(t){var e=t.coreData,n=t.x,r=t.y,o=t.scale;return{node:e.node,x:n+e.deltaX/o,y:r+e.deltaY/o,deltaX:e.deltaX/o,deltaY:e.deltaY/o,lastX:n,lastY:r}}var A={start:"mousedown",move:"mousemove",stop:"mouseup"},R={start:"touchstart",move:"touchmove",stop:"touchend"},k=A,V=function(t){var n=t.children,r=t.allowAnyClick,o=t.disable,a=t.handle,c=t.cancel,l=t.grid,s=t.domRef,d=t.scale,g=void 0===d?1:d,p=t.enableUserSelect,y=void 0===p||p,v=t.onStart,h=void 0===v?function(){return 0}:v,b=t.onDrag,S=void 0===b?function(){return 0}:b,D=t.onStop,N=void 0===D?function(){return 0}:D,T=t.onMousedown,X=void 0===T?function(){return 0}:T,Y=e.useRef({lastX:NaN,lastY:NaN,dragging:!1,touchIndentifier:null}),M=e.useRef(null),P=function t(e){var n=Y.current;if(n.dragging){var r=C(e,M,n.touchIndentifier,g);if(null!==r){var o=r.x,a=r.y,c=L(M,n,o,a);!1!==N(e,c)&&(M.current&&y&&j(M.current.ownerDocument),m("DragCore - handleStop: %j",c),Y.current=i(i({},n),{},{dragging:!1,lastX:NaN,lastY:NaN}),M&&(x(M.current.ownerDocument,k.move,V),x(M.current.ownerDocument,k.stop,t)))}}},V=function(t){var e=Y.current,n=C(t,M,e.touchIndentifier,g);if(null!==n){var r=n.x,o=n.y;if(Array.isArray(l)){var a=u(function(t,e,n){return[Math.round(e/t[0])*t[0],Math.round(n/t[1])*t[1]]}(l,r-e.lastX,o-e.lastY),2),c=a[0],s=a[1];if(!c&&!s)return;r=e.lastX+c,o=e.lastY+s}var f=L(M,e,r,o);m("DragCore - handleDrag: %j",f),!1!==S(t,f)?Y.current=i(i({},e),{},{dragging:!0,lastX:r,lastY:o}):P(new MouseEvent("mouseup"))}},B=function(t){var e=Y.current;if(X&&X(t),r||0===t.button){var n=M.current;if(!n||!n.ownerDocument||!n.ownerDocument.body)throw new Error("Draggable not mounted on DragStart");var u=n.ownerDocument;if(!(o||!(t.target instanceof u.defaultView.Node)||a&&!E(t.target,a,n)||c&&E(t.target,c,n))){"touchstart"===t.type&&t.preventDefault();var l=function(t){return t.targetTouches&&t.targetTouches[0]?t.targetTouches[0].identifier:t.changedTouches&&t.changedTouches[0]?t.changedTouches[0].identifier:void 0}(t);Y.current=i(i({},e),{},{touchIndentifier:l});var s=C(t,M,l,g);if(null!==s){var f=s.x,d=s.y,p=L(M,e,f,d);m("DragCore - handleDragStart: %j",p),!1!==h(t,p)&&(y&&O(u),Y.current=i(i({},e),{},{dragging:!0,lastX:f,lastY:d}),w(u,k.move,V),w(u,k.stop,P))}}}},I=function(t){return k=R,B(t)};return e.useEffect((function(){return M&&(f(s)&&s(M),w(M.current,R.start,I,{passive:!1})),function(){if(null==M?void 0:M.current){var t=M.current.ownerDocument;x(t,A.move,V),x(t,R.move,V),x(t,A.stop,P),x(t,R.stop,P),x(M.current,R.start,I,{passive:!1}),y&&j(t)}}}),[M]),e.cloneElement(n,{ref:M,onMouseDown:function(t){return k=A,B(t)},onMouseUp:function(t){return k=A,P(t)},onTouchEnd:function(t){return k=R,P(t)}})};t.DragCore=V,t.default=function(t){var c,l,s=t.children,f=t.style,v=t.className,w=t.draggedClassName,x=t.draggingClassName,S=t.position,D=t.bounds,E=t.positionOffset,O=t.scale,j=void 0===O?1:O,C=t.axis,L=void 0===C?"both":C,A=t.startPosition,R=void 0===A?{x:0,y:0}:A,k=t.onStop,B=t.onStart,I=t.onDrag,W=e.useRef(null),G=function(t){var n=u(e.useState(t),2),r=n[0],o=n[1],a=e.useRef(r);return[a,function(t){a.current=t,o(t)},r]}({dragging:!1,dragged:!1,x:null!==(c=null==S?void 0:S.x)&&void 0!==c?c:R.x,y:null!==(l=null==S?void 0:S.y)&&void 0!==l?l:R.y,prevPropsPos:i({},S),slackX:0,slackY:0,isElementSVG:!1}),H=u(G,3),U=H[0],q=H[1],z=H[2],_=u(e.useState({style:{},className:"",transform:""}),2),F=_[0],$=_[1];e.useEffect((function(){void 0!==window.SVGAElement&&W.current instanceof window.SVGAElement&&q(i(i({},U.current),{},{isElementSVG:!0}))}),[W]),e.useEffect((function(){var t,e=U.current,r=!Boolean(S)||e.dragging,a=S||R,c={x:p(L)&&r?e.x:a.x,y:y(L)&&r?e.y:a.y},u=null,l={};e.isElementSVG?u=function(t,e){return M(t,e,"")}(c,E):l=function(t,e){var n=M(t,e,"px");return o({},h("transform",b),n)}(c,E);var d=n(v||"",s.props.className||"",(o(t={},w,e.dragged),o(t,x,e.dragging),t));$({style:i(i({},f),l),className:d,transform:u})}),[z]),e.useEffect((function(){if(S&&!U.current.dragging){var t=S.x,e=S.y;q(i(i({},U.current),{},{x:t,y:e}))}}),[S]);return r.createElement(V,a({},i(i({},t),{},{onStart:function(t,e){var n=U.current;if(m("Draggable: handleDragStart: %j",e),!1===(B&&B(t,P({x:n.x,y:n.y,scale:j,coreData:e}))))return!1;q(i(i({},n),{},{dragging:!0,dragged:!0}))},onDrag:function(t,e){var n=U.current;if(n.dragging){m("Draggable: handleDrag: %j",e);var r=P({x:n.x,y:n.y,scale:j,coreData:e}),o={x:r.x,y:r.y};if(D){var a=o.x,c=o.y;o.x+=n.slackX,o.y+=n.slackY;var l=u(function(t,e,n,r){if(!e)return[n,r];var o=n,a=r,c="string"==typeof e?{}:function(t){return{left:t.left,right:t.right,top:t.top,bottom:t.bottom}}(e);if("string"==typeof e){var i,u=t.ownerDocument,l=u.defaultView;if(!((i="parent"===e?t.parentNode:u.querySelector(e))instanceof l.HTMLElement))throw new Error('Bounds selector "'.concat(e,'" not exist.'));var s=l.getComputedStyle(t),f=l.getComputedStyle(i);c={left:-t.offsetLeft+g(f.paddingLeft)+g(s.marginLeft),top:-t.offsetTop+g(f.paddingTop)+g(s.marginTop),right:X(i)-N(t)-t.offsetLeft+g(f.paddingRight)-g(s.marginRight),bottom:Y(i)-T(t)-t.offsetTop+g(f.paddingBottom)-g(s.marginBottom)}}return d(c.right)&&(o=Math.min(o,c.right)),d(c.bottom)&&(a=Math.min(a,c.bottom)),d(c.left)&&(o=Math.max(o,c.left)),d(c.top)&&(a=Math.max(a,c.top)),[o,a]}(W.current,D,o.x,o.y),2),s=l[0],f=l[1];o.x=s,o.y=f,o.slackX=n.slackX+(a-o.x),o.slackY=n.slackY+(c-o.y),r.x=o.x,r.y=o.y,r.deltaX=o.x-n.x,r.deltaY=o.y-n.y}if(!1===(I&&I(t,r)))return!1;q(i(i({},n),o))}},onStop:function(t,e){var n=U.current;if(n.dragging){if(!1===(k&&k(t,e)))return!1;m("Draggable: onDragStop: %j",e);q(i(i({},n),{dragging:!1,slackX:0,slackY:0}))}}}),{domRef:function(t){W.current=t.current}}),e.cloneElement(s,i({},F)))},Object.defineProperty(t,"__esModule",{value:!0})}));
